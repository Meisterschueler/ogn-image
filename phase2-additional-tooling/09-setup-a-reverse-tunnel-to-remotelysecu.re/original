# step 9: setup a reverse tunnel to remotelysecu.re
# NOTE: this step enables easy access to your Pi from your local network and is
#       required if you want the benefits of secure remote login to your Pi.
HUB=remotelysecu.re
HIGHPORT=61522
# install required packages
apt -y install autossh
# create config file
mkdir -p /etc/remotelysecure
cat > /etc/remotelysecure/server.conf <<-EOF
server:$HUB
EOF
# install script
cp remotelysecure-client.sh /usr/local/bin
cp send-hostname.sh /usr/local/bin
# install the service
cp remotelysecure-client.service /lib/systemd/system/
# get hostkey of remotelysecure server
mkdir ~/.ssh
ssh-keyscan -p $HIGHPORT -t rsa $HUB >> ~/.ssh/known_hosts
# enable the service 
systemctl daemon-reload
systemctl enable --now remotelysecure-client